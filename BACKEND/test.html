<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BACKEND TEST</title>
</head>
<body>
    <script>

        // Define a post request function
        async function req(type, act, data) {
            // Try to perform the CRUD operation
            try {
                // Wait for the server response
                const response = await fetch('https://localhost:4443/', {
                    // Specify the request type/headers
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    // Define the request body
                    body: JSON.stringify({
                        'type': type,
                        'act': act,
                        'data': data,
                    }),
                });

                // If the response is not ok, throw an error
                if (!response.ok) {
                    throw new Error('network response was not ok');
                }

                // Determine the content type
                const contentType = response.headers.get('Content-Type');

                // Try to parse based on content type
                if (contentType && contentType.includes('application/json')) {
                    const json = await response.json();
                    console.log('Server responded with JSON:', json);
                    return json;
                } else {
                    const text = await response.text();
                    console.log('Server responded with plain text:', text);
                    return text;
                }
            } 
            // Catch a fetch error
            catch (error) {
                console.error('There was a problem with your fetch operation:', error);
            }
        }
        
        //user creation test
        console.log(req('create', 'user', ['testUser@example.com', 'password', 'test', '0/0/0000']))

        //sign in test
        console.log(req('sign in', null, ['testUser@example.com', 'password']))

        // //creation test
        // function creationTest() {

        //     //create an appointment
        //     req('create', 'appointment', [1, 'status', 'dateTime'])

        //     //create feedback
        //     req('create', 'feedback', [1, '5', 'test'])

        // }
        // creationTest()

        // //retrieval test
        // function retrievalTest() {

        //     //retrieve a user
        //     req('retrieve', 'user', null)

        //     //retrieve an appointment
        //     req('retrieve', 'appointment', null)

        //     //retrieve feedback
        //     req('retrieve', 'feedback', null)
        // }
        // retrievalTest()

        // //update test
        // function updateTest() {

        //     //update the user
        //     req('update', 'user', ['updatedTestUser@example.com', 'updated password'])

        //     //update an appointment
        //     req('update', 'appointment', [1, 'updated status', 'dateTime'])

        //     //update feedback
        //     req('update', 'feedback', [clinicID, '6', 'updatedtest'])

        // }
        // updateTest()

        // //deletion test
        // function deleteTest() {

        //     //delete an appointment
        //     req('delete', 'appointment', [])

        //     //delete feedback
        //     req('delete', 'feedback', [])

        //     //delete a user
        //     req('delete', 'user', null)

        // }
        // deleteTest()

    </script>
</body>
</html>
