<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clinic Search</title>
    <link rel="stylesheet" href="main.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
    <header>
        <img src="RSLogo.png" alt="AcadiaPG">
    </header>
    <div class="navbar">
        <span id="open-btn" onclick="openNav()">☰</span>
        <a href="Home.html" class="right">Sign Out</a>
    </div>
    <div id="sideNav" class="sidenav">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">×</a>
        <a href="patientDB.html">Management</a>
        <a href="index.html">Site Finder</a>
        <a href="contactForm.html">Contact Us</a>
    </div>

    <main>
    <div class="container1">
        <div class="container2">
            <div class="container">
                <h1>Find The Nearest Clinic</h1>
                <form id="clinicForm">
                    <label for="reason">Reason for Visit:</label>
                    <input type="text" id="reason" name="reason" placeholder="Enter reason for visit">

                    <label for="postal_code">Postal Code:</label>
                    <input type="text" id="postal_code" name="postal_code" placeholder="Enter postal code">

                    <button type="submit" class="btn">Search</button>
                </form>

                <div id="results"></div>
            </div>
        </div>
    </div>
    </main>

    <script>
        function openNav() {
                document.getElementById("sideNav").style.width = "250px";
                document.getElementById("main").style.marginLeft = "250px";
            }
        
            function closeNav() {
                document.getElementById("sideNav").style.width = "0";
                document.getElementById("main").style.marginLeft= "0";
            }
            
        $(document).ready(function() {
            $('#clinicForm').submit(function(event) {
                event.preventDefault();
                var formData = $(this).serialize();
                $.ajax({
                    type: 'POST',
                    url: '/search',
                    data: formData,
                    success: function(response) {
                        var clinics = response.clinics;
                        var resultsHtml = '<h2>Available Clinics</h2><ul>';
                        if (clinics.length > 0) {
                            for (var i = 0; i < clinics.length; i++) {
                                resultsHtml += '<li>' + clinics[i] + '</li>';
                            }
                        } else {
                            resultsHtml += '<li>No clinics available for your visit.</li>';
                        }
                        resultsHtml += '</ul>';
                        $('#results').html(resultsHtml);
                    },
                    error: function(xhr, status, error) {
                        console.error(xhr.responseText);
                    }
                });
            });
        });
    </script>
</body>
</html>
